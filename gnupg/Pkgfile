# Description: GNU privacy guard
# URL: http://www.gnupg.org
# Maintainer: Simon Gloﬂner, viper at hometux dot de
# Packager: Daniel Mueller, daniel at danm dot de

name=gnupg
version=1.4.3
release=2
source=(ftp://ftp.gnupg.org/gcrypt/gnupg/$name-$version.tar.bz2 \
	ftp://ftp.gnupg.dk/pub/contrib-dk/idea.c.gz \
	$name-$version-mguard.patch)

build () {
    cd $name-$version

    # necessary because of --enable-m-guard
    patch -p1 < $SRC/$name-$version-mguard.patch

    zcat ../idea.c.gz > cipher/idea.c

    ./configure \
	--prefix=/usr \
	--libexecdir=/usr/lib \
	--enable-static-rnd=linux \
        --enable-dev-random \
	--enable-m-guard \
        --disable-nls \
        --disable-ldap \
	--enable-mailto

    make
    make DESTDIR=$PKG install

    chmod u+s $PKG/usr/bin/gpg

    rm -rf $PKG/usr/info
    rm -f $PKG/usr/share/gnupg/{FAQ,faq.html}
    rm -f $PKG/usr/man/man?/gpg.ru.*
}
