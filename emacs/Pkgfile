# Description: an extensible, customizable, self-documenting real-time display editor
# URL: http://www.gnu.org/software/emacs/
# Maintainer: Antti Nykanen, aon at iki dot fi
# Depends on: xorg, libtiff, ctags

name=emacs
version=23.1
release=1
source=(http://ftp.gnu.org/gnu/$name/$name-$version.tar.gz
	$name-$version-etc-blacklist)

build() {
	cd $name-$version

	./configure \
		--prefix=/usr \
		--libexecdir=/usr/lib \
		--mandir=/usr/man \
		--localstatedir=/usr/lib/emacs/$version \
		--with-x \
		--without-makeinfo

	make
	make DESTDIR=$PKG install

	rm -rf $PKG/usr/share/info
	find $PKG/usr/share/emacs -name "*.el.gz" | while read file; do
		[ -f ${file%.gz}c ] && rm -f $file
	done

	rm $PKG/usr/bin/emacs-$version 
	rm $PKG/usr/{bin/{c,e}tags,man/man1/{c,e}tags.1}
	rm $PKG/usr/share/emacs/$version/lisp/{COPYING,calc/README.prev,nxml/TODO,{,term/,international/}README}

	for i in $(< $SRC/$name-$version-etc-blacklist); do
		rm -r $PKG/usr/share/emacs/$version/etc/$i
	done

	chown -R root:root $PKG
}
